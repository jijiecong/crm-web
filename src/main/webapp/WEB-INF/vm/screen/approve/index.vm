<script src="http://g.tbcdn.cn/kissy/k/1.3.1/seed.js" data-config="{combine:true}"></script>
<script type="text/javascript" src="${formLink}/admin/static/js/component/mustache.js"></script>

<style>
    /*暂时把显示图片的属性写在这里*/
    .image_div{
        width: 400px;
        height: 300px;
        /*padding: 10px 10px 10px 10px;*/
        margin-top:10px;
        margin-bottom:20px;
    }
</style>

<div class="page-content">
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span12">
                <h3 class="page-title">提现账号审核</h3>
            </div>
        </div>
        <div class="row-fluid margin-bottom-20 content-area">
            <div class="span12 list-action-top-area">
                <form action="/approve/index" class="form-horizontal listSearchBox" method="post">
                    <div class="span12">
                        <select name="status" data-width="auto">
                            <option value="APPROVING"
                                #if($!status=="APPROVING")
                                    selected="selected"
                                #end
                            >审核中
                            </option>
                            <option value="FAIL"
                                #if($!status=="FAIL")
                                    selected="selected"
                                #end
                            >审核失败
                            </option>
                            <option value="SUCCESS"
                                #if($!status=="SUCCESS")
                                    selected="selected"
                                #end
                            >审核通过
                            </option>
                        </select>
                        <button type="submit" class="btn search-btn">搜 索</button>
                    </div>
                </form>
            </div>
            <div class="portlet box green">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-cogs"></i>
                        账号列表
                    </div>
                </div>

                <div class="portlet-body">
                    <table class="table table-condensed table-hover">
                        <thead>
                        <tr>
                            <th>编号</th>
                            <th>真实姓名</th>
                            <th>身份证号</th>
                            <th>审核状态</th>
                            <th>备注</th>
                            <th>创建时间</th>
                            <th>修改时间</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                            #foreach($accountVO in $accountVOList)
                            <tr class="u_$!accountVO.id">
                                <td class="account_id">$!accountVO.id</td>
                                <td class="account_name">$!accountVO.name</td>
                                <td class="account_IDnum">$!accountVO.IDnum</td>
                                <td class="account_status">$!accountVO.status</td>
                                <td class="account_remark">$!accountVO.remark</td>
                                <td class="account_img1" style="display: none">$!accountVO.images[0]</td>
                                <td class="account_img2" style="display: none">$!accountVO.images[1]</td>
                                <td class="account_gmt_create">$dateUtils.format($!accountVO.gmtCreated,
                                    "yyyy-MM-dd HH:mm:ss")</td>
                                <td class="account_gmt_modify">$dateUtils.format($!accountVO.gmtModified,
                                    "yyyy-MM-dd HH:mm:ss")</td>
                                <td>
                                    <div class="btn-group">
                                        #if("APPROVING"!=$!status)
                                            <a class="btn mini purple account_detail" href="#" data-toggle="dropdown"
                                               data-uid="$!accountVO.id">
                                                <i class="icon-cog"></i> 详情 <i class="icon-angle-down"></i>
                                            </a>
                                        #else
                                            <a class="btn mini purple approve_account" href="#" data-toggle="dropdown"
                                               data-uid="$!accountVO.id">
                                                <i class="icon-cog"></i> 审核 <i class="icon-angle-down"></i>
                                            </a>
                                        #end
                                    </div>
                                </td>
                            </tr>
                            #end
                        </tbody>
                    </table>
                </div>
            </div>
        ##		实现分页功能
            #if ($totalCount > 0)
                <div class="pages" style="padding:3px">
                    #set($cpage = $pageUtil.pager($curPage, $pageSize, $totalCount))
				        #set($url = $formLink.setTarget('/approve/index').addQueryData('status', "$!status").fork())
				   		#showPage($cpage $url)
                </div>
            #end
        </div>
    </div>

##详情页面模板
    <script type="text/html" id="show_account_detail">
##        <div class="cq-into-edit">
        <div style="font-size: 16px;padding-left: 20px;padding-top:20px;padding-right:20px;">
            <tr>
            ##            这里想着换成td标签 但是取不到自定义属性。。。。
                <div id="approve_account_id" uuid="{{account_id}}">编号:{{account_id}}</div>
                <td>姓名:{{account_name}}</td>
                <td>身份证号:{{account_IDnum}}</td>
##                <td><strong>审核状态：</strong>{{account_status}}</td>
                <td>备注:{{account_remark}}</td>
                <td>创建时间:{{account_gmt_create}}</td>
                <td>修改时间:{{account_gmt_modify}}</td>
            </tr>
            <div>
                <div  style="float:left"><img class="image_div" src="{{account_img1}}"></div>
                <div  style="float:left"><img class="image_div" src="{{account_img2}}"></div>
            </div>
        </div>
    </script>

##审核模板
    <script type="text/html" id="approve_account">
        <div style="margin-left:20px;margin-bottom:20px;margin-right:20px;">
            <input id="approve_input_id" placeholder="输入审核核备注"
                   style="height: 35px; border: 1px solid #09c;"></input>
            <button id="approve_account_fail_btn_id"
                    style=" color: #fff; border: 1px solid #09c; background-color: #09c;margin-left:10px;height:40px;width: 140px; font-size:18px;">
                不通过
            </button>
            <button id="approve_account_success_btn_id"
                    style="color: #fff; border: 1px solid #09c; background-color: #09c;margin-right:10px; margin-left:10px;height:40px;width: 140px; font-size:18px;">
                通 过
            </button>
            <script>
                $("#approve_account_success_btn_id").on("click", function (e) {
                    $.ajax({
                        type: "POST",
                        dataType: "json",
                        async: false,
                        data: {
                            id: $('#approve_account_id').attr('uuid'),
                            remark: $('#approve_input_id').val()
                        },
                        url: "/approve/success",
                        success: function (result) {
                            if (result.success) {
                                $("#account_detail_div").remove();
                                $("#account_detail_divBg").remove();
                            } else {
                                alert(result.error);
                            }
                        }
                    });
                });

                $("#approve_account_fail_btn_id").on("click", function (e) {
                    $.ajax({
                        type: "POST",
                        dataType: "json",
                        async: false,
                        data: {
                            id: $('#approve_account_id').attr('uuid'),
                            remark: $('#approve_input_id').val()
                        },
                        url: "/approve/fail",
                        success: function (result) {
                            if (result.success) {
                                $("#account_detail_div").remove();
                                $("#account_detail_divBg").remove();
                            } else {
                                alert(result.error);
                            }
                        }
                    });
                });

    </script>
</div>

    <script>
        seajs.use("$formLink/admin/static/app/approve/approve", function (main) {
            main.init();
        });
    </script>

